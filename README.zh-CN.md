# éçº¿æ€§èŠå¤©æœºå™¨äºº ğŸŒ³

[![GitHub stars](https://img.shields.io/github/stars/WASD2HJKL/Non-Linear-Chatbot?style=for-the-badge&logo=github&label=Stars&logoColor=white&color=ffda65)](https://github.com/WASD2HJKL/Non-Linear-Chatbot/stargazers)

[English](README.md) | [ç®€ä½“ä¸­æ–‡](README.zh-CN.md)

ä¸€æ¬¾é©å‘½æ€§çš„å¯¹è¯å¼ AI åº”ç”¨ç¨‹åºï¼Œçªç ´äº†ä¼ ç»Ÿçº¿æ€§èŠå¤©ç•Œé¢çš„é™åˆ¶ã€‚åˆ›å»ºåˆ†æ”¯å¯¹è¯æ ‘ï¼Œæ¢ç´¢å¤šæ¡å¯¹è¯è·¯å¾„ï¼Œå¹¶å°†æ‚¨çš„å¯¹è¯å¯è§†åŒ–ä¸ºäº¤äº’å¼èŠ‚ç‚¹å›¾ã€‚

![Version](https://img.shields.io/badge/version-0.0.2-blue)
![License](https://img.shields.io/badge/license-MIT-green)
![Node](https://img.shields.io/badge/node-%3E%3D22-brightgreen)
![Wasp](https://img.shields.io/badge/wasp-0.17.0-yellow)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸŒ¿ åˆ†æ”¯å¯¹è¯

- åœ¨ä»»æ„ç‚¹åˆ†å‰å¯¹è¯ä»¥æ¢ç´¢ä¸åŒçš„å¯¹è¯è·¯å¾„
- æ— ç¼åœ°åœ¨å¯¹è¯åˆ†æ”¯ä¹‹é—´å¯¼èˆª
- åœ¨æ¢ç´¢æ›¿ä»£å›å¤æ—¶ä¿ç•™ä¸Šä¸‹æ–‡

### ğŸ“Š äº¤äº’å¼å¯è§†åŒ–

- åŸºäº ReactFlow çš„å®æ—¶å¯¹è¯æ ‘å¯è§†åŒ–
- æ‹–æ”¾èŠ‚ç‚¹æ¥ç»„ç»‡æ‚¨çš„å¯¹è¯åœ°å›¾
- å¯è°ƒæ•´å¤§å°çš„é¢æ¿ä»¥è·å¾—æœ€ä½³æŸ¥çœ‹ä½“éªŒ
- æ´»åŠ¨å¯¹è¯çº¿ç¨‹çš„è§†è§‰è·¯å¾„é«˜äº®
- å±•å¼€å…¨éƒ¨/æŠ˜å å…¨éƒ¨æŒ‰é’®ï¼Œä¾¿äºç®¡ç†å¤§å‹å¯¹è¯æ ‘

### ğŸ¤– AI é›†æˆ

- æ”¯æŒ OpenAI å…¼å®¹ API æ¥å£çš„å¤šæä¾›å•† AI æ”¯æŒ
- æœåŠ¡å™¨ç«¯æµå¼ä¼ è¾“ä»¥ç¡®ä¿ API å¯†é’¥å®‰å…¨ç®¡ç†
- æ”¯æŒ OpenAIã€Geminiã€OpenRouter å’Œå…¶ä»–äº‘æä¾›å•†
- **æœ¬åœ° AI æ¨¡å‹æ”¯æŒ**ç”¨äºå¼€å‘ï¼ˆOllamaã€phi3-mini ç­‰ï¼‰
- å¼€å‘ç¯å¢ƒçš„æœ¬åœ°ä»£ç†é…ç½®
- åŸºäºé˜Ÿåˆ—çš„ NDJSON è§£æçš„å®æ—¶å“åº”æµ
- é€šè¿‡ç”¨æˆ·å‹å¥½çš„è®¾ç½®è¿›è¡Œå¯é…ç½®çš„æä¾›å•†å’Œæ¨¡å‹é€‰æ‹©
- è·¨æä¾›å•†çš„ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œè§„èŒƒåŒ–

### ğŸ¨ ç°ä»£åŒ– UI/UX

- å¹²å‡€ã€å“åº”å¼çš„åŸºäº Bootstrap çš„è®¾è®¡
- æ”¯æŒæ·±è‰²/æµ…è‰²ä¸»é¢˜ï¼Œé›¶é—ªçƒåˆ‡æ¢
- å¯è°ƒæ•´å¤§å°çš„é¢æ¿å¸ƒå±€ï¼Œå…·æœ‰æŒä¹…çŠ¶æ€

### ğŸ“¤ å¯¼å‡ºä¸åˆ†äº«

- å°†æ•´ä¸ªå¯¹è¯æ ‘å¯¼å‡ºä¸ºäº¤äº’å¼ HTML æ–‡ä»¶
- ä¿ç•™å¯¹è¯ç»“æ„å’Œæ ¼å¼
- å¯ç¦»çº¿å·¥ä½œçš„ç‹¬ç«‹æ–‡ä»¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 22 æˆ–æ›´é«˜ç‰ˆæœ¬
- PostgreSQL æ•°æ®åº“
- OpenAI API å¯†é’¥ï¼ˆæˆ–å…¼å®¹æä¾›å•†çš„ API å¯†é’¥ï¼‰
- **å¯é€‰ï¼š** Docker å’Œ Docker Compose ç”¨äºæœ¬åœ° AI æ¨¡å‹

> **æ³¨æ„**ï¼šæ­¤åº”ç”¨ç¨‹åºæ”¯æŒä»»ä½•å…·æœ‰ OpenAI å…¼å®¹ API ç«¯ç‚¹çš„ AI æä¾›å•†ã€‚æ‰€æœ‰æä¾›å•†å¿…é¡»ä½¿ç”¨æ ‡å‡†çš„ `Authorization: Bearer <api-key>` å¤´æ ¼å¼è¿›è¡Œèº«ä»½éªŒè¯ã€‚

### å®‰è£…

1. **å…‹éš†ä»“åº“**

    ```bash
    git clone https://github.com/WASD2HJKL/Non-Linear-Chatbot.git
    cd Non-Linear-Chatbot
    ```

2. **è®¾ç½®ç¯å¢ƒå˜é‡**

    ```bash
    cp .env.server.example .env.server
    ```

    ç¼–è¾‘ `.env.server` å¹¶æ·»åŠ æ‚¨çš„é…ç½®ï¼š

    ```env
    # AI æä¾›å•† API å¯†é’¥ï¼ˆåŸºäºçº¦å®šçš„å‘½åï¼‰
    OPENAI_API_KEY=your_openai_api_key_here
    GEMINI_API_KEY=your_gemini_api_key_here
    HUGGINGFACE_API_KEY=hf_your_huggingface_token_here

    # å¯é€‰ï¼šGoogle OAuth
    GOOGLE_CLIENT_ID=your_google_client_id
    GOOGLE_CLIENT_SECRET=your_google_client_secret
    ```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**

    ```bash
    wasp start
    ```

4. **è®¿é—®åº”ç”¨ç¨‹åº**

    åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://localhost:3000

### æœ¬åœ° AI æ¨¡å‹ï¼ˆä»…é™å¼€å‘ç¯å¢ƒï¼‰

ç”¨äºä½¿ç”¨æœ¬åœ° AI æ¨¡å‹è€Œéäº‘ API è¿›è¡Œå¼€å‘ï¼š

ğŸ“– **æŸ¥çœ‹ [LOCAL_SETUP.md](./LOCAL_SETUP.md)** è·å–å®Œæ•´çš„è®¾ç½®è¯´æ˜

**ä½¿ç”¨ Docker å¿«é€Ÿå¼€å§‹ï¼š**

```bash
# å¯åŠ¨æœ¬åœ° Ollama æœåŠ¡
cd docker/local-models
docker-compose up -d

# ä¸‹è½½ phi3-mini æ¨¡å‹
docker-compose exec ollama ollama pull phi3:mini

# æ·»åŠ åˆ° .env.server
echo "OLLAMA_API_KEY=local-dummy-key" >> .env.server
```

> âš ï¸ **ä»…é™å¼€å‘ç¯å¢ƒï¼š** æœ¬åœ° AI æ¨¡å‹ä»…ç”¨äºå¼€å‘ç¯å¢ƒã€‚ç”Ÿäº§éƒ¨ç½²ä½¿ç”¨äº‘æä¾›å•†ã€‚

### ç”Ÿäº§æ„å»º

```bash
wasp build
```

æ„å»ºè¾“å‡ºå°†ä½äºï¼š

- å‰ç«¯ï¼š`.wasp/build/web-app/`
- åç«¯ï¼š`.wasp/build/server/`

## ğŸ—ï¸ æ¶æ„

### é¡¹ç›®ç»“æ„

```
Non-Linear-Chatbot/
â”œâ”€â”€ main.wasp              # Wasp é…ç½®å’Œè·¯ç”±
â”œâ”€â”€ schema.prisma          # æ•°æ®åº“æ¨¡å¼
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/        # React ç»„ä»¶
â”‚   â”œâ”€â”€ contexts/          # React ä¸Šä¸‹æ–‡ï¼ˆä¸»é¢˜ç­‰ï¼‰
â”‚   â”œâ”€â”€ hooks/             # è‡ªå®šä¹‰ React é’©å­
â”‚   â”œâ”€â”€ server/
â”‚   â”‚   â”œâ”€â”€ actions/       # æœåŠ¡å™¨ç«¯å˜æ›´
â”‚   â”‚   â”œâ”€â”€ queries/       # æœåŠ¡å™¨ç«¯æŸ¥è¯¢
â”‚   â”‚   â”œâ”€â”€ middleware/    # Express ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ openaiStream.ts # å¤šæä¾›å•† AI æµå¼ç«¯ç‚¹
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”œâ”€â”€ styles/            # CSS æ–‡ä»¶
â”‚   â””â”€â”€ utils/             # å®ç”¨å‡½æ•°
â””â”€â”€ public/                # é™æ€èµ„æº
```

### å…³é”®è®¾è®¡æ¨¡å¼

- **åŸºäºèŠ‚ç‚¹çš„å¯¹è¯å­˜å‚¨**ï¼šæ¯ä¸ªæ¶ˆæ¯å¯¹æ˜¯æ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹
- **å¤šæä¾›å•† AI æ¶æ„**ï¼šæ”¯æŒ OpenAI å…¼å®¹ API çš„ç»Ÿä¸€å®¢æˆ·ç«¯å·¥å‚
- **é›†ä¸­å¼å­˜å‚¨æœåŠ¡**ï¼šå…·æœ‰è¿ç§»æ”¯æŒçš„ä¸€è‡´ localStorage å¤„ç†
- **åŸºäºé˜Ÿåˆ—çš„æµå¼ä¼ è¾“**ï¼šé˜²æ­¢æ•°æ®ä¸¢å¤±çš„å¼ºå¤§ NDJSON è§£æ
- **ç»„ä»¶æ¨¡å—åŒ–**ï¼šå…·æœ‰æ˜ç¡®å…³æ³¨ç‚¹åˆ†ç¦»çš„å¯é‡ç”¨ UI ç»„ä»¶
- **é”™è¯¯è§„èŒƒåŒ–**ï¼šè·¨ä¸åŒ AI æä¾›å•†çš„æ ‡å‡†åŒ–é”™è¯¯å¤„ç†

## âš™ï¸ æä¾›å•†é…ç½®

åº”ç”¨ç¨‹åºé€šè¿‡ç»Ÿä¸€çš„é…ç½®ç³»ç»Ÿæ”¯æŒå¤šä¸ª AI æä¾›å•†ã€‚æ‰€æœ‰æä¾›å•†å¿…é¡»æ”¯æŒ OpenAI å…¼å®¹çš„ API ç«¯ç‚¹ã€‚

### æ·»åŠ æ–°çš„æä¾›å•†

ç¼–è¾‘ `src/config.js` ä»¥æ·»åŠ æ–°çš„æä¾›å•†ï¼š

```javascript
providers: [
    {
        id: "openai",
        name: "OpenAI",
        url: "https://api.openai.com/v1",
        timeout: 30000,
        retries: 3,
        models: [
            { id: "gpt-4o", name: "GPT-4o" },
            { id: "gpt-4.1", name: "GPT-4.1" },
            { id: "gpt-5-chat-latest", name: "GPT-5 Chat" },
            { id: "gpt-4o-mini", name: "GPT-4o Mini" },
            { id: "gpt-4.1-mini", name: "GPT-4.1 Mini" },
            { id: "gpt-4.1-nano", name: "GPT-4.1 Nano" },
            { id: "gpt-5", name: "GPT-5 (Thinking)" },
            { id: "gpt-5-mini", name: "GPT-5 Mini" },
            { id: "o4-mini", name: "O4 Mini" },
        ],
    },
    {
        id: "huggingface",
        name: "Hugging Face",
        url: "https://router.huggingface.co/v1",
        timeout: 30000,
        retries: 3,
        models: [
            { id: "deepseek-ai/DeepSeek-R1:together", name: "DeepSeek R1" },
            { id: "meta-llama/Llama-3.2-90B-Vision-Instruct", name: "Llama 3.2 90B Vision" },
        ],
    },
];
```

### è¦æ±‚

- **API å…¼å®¹æ€§**ï¼šå¿…é¡»æ”¯æŒ OpenAI çš„èŠå¤©å®Œæˆ API æ ¼å¼
- **èº«ä»½éªŒè¯**ï¼šå¿…é¡»ä½¿ç”¨ `Authorization: Bearer <api-key>` å¤´æ ¼å¼
- **æµå¼ä¼ è¾“**ï¼šå¿…é¡»æ”¯æŒæœåŠ¡å™¨å‘é€äº‹ä»¶ä»¥å®ç°å®æ—¶å“åº”
- **é”™è¯¯æ ¼å¼**ï¼šé”™è¯¯å°†è‡ªåŠ¨è§„èŒƒåŒ–ä¸ºæ ‡å‡†æ ¼å¼

### API å¯†é’¥é…ç½®

åº”ç”¨ç¨‹åºä½¿ç”¨åŸºäºçº¦å®šçš„ API å¯†é’¥ç³»ç»Ÿï¼š

**çº¦å®š**ï¼š`{PROVIDER_ID}_API_KEY`

ç¤ºä¾‹ï¼š

- OpenAIï¼š`OPENAI_API_KEY=sk-your_key_here`
- Geminiï¼š`GEMINI_API_KEY=your_gemini_key_here`
- Hugging Faceï¼š`HUGGINGFACE_API_KEY=hf_your_token_here`

**å‘åå…¼å®¹æ€§**ï¼šå¦‚æœæ‰¾ä¸åˆ°ç‰¹å®šäºæä¾›å•†çš„å¯†é’¥ï¼Œç³»ç»Ÿå°†å›é€€åˆ° `OPENAI_API_KEY`ã€‚è¿™ç¡®ä¿ç°æœ‰è®¾ç½®æ— éœ€æ›´æ”¹å³å¯ç»§ç»­å·¥ä½œã€‚

## ğŸŒ éƒ¨ç½²

### åç«¯ (Heroku)

è¯¥é¡¹ç›®åŒ…å«ç”¨äº Heroku éƒ¨ç½²çš„ Docker é…ç½®ï¼š

```bash
heroku create your-app-name
heroku addons:create --app your-app-name heroku-postgresql:mini # å¯é€‰ï¼Œå¦‚æœæ‚¨æƒ³ä½¿ç”¨ Heroku æ•°æ®åº“
                                                                # å¦åˆ™æ‚¨éœ€è¦è®¾ç½® DATABASE_URL ç¯å¢ƒå˜é‡
heroku config:set --app your-app-name OPENAI_API_KEY=sk-xxx     # å¯¹å…¶ä»–ç¯å¢ƒå˜é‡æ‰§è¡Œç›¸åŒæ“ä½œ
```

### å‰ç«¯ (Netlify)

è¦å°†å‰ç«¯æ„å»ºéƒ¨ç½²åˆ° Netlifyï¼Œè¯·åœ¨ `Netlify` æ‰‹åŠ¨åˆ›å»ºé¡¹ç›®å¹¶è®¾ç½® GitHub Actions å¯†é’¥ï¼Œç„¶åè¿è¡Œç®¡é“ã€‚

### GitHub Actions CI/CD

ä»“åº“åŒ…å«è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥ä½œæµï¼Œå®ƒä¼šï¼š

- åœ¨æ¨é€åˆ° main æ—¶æ„å»ºå’Œæµ‹è¯•
- å°†åç«¯éƒ¨ç½²åˆ° Heroku
- å°†å‰ç«¯éƒ¨ç½²åˆ° Netlify

æ‰€éœ€çš„ GitHub Secretsï¼š

- `HEROKU_API_KEY`
- `HEROKU_APP_NAME`
- `NETLIFY_AUTH_TOKEN`
- `NETLIFY_SITE_NAME`
- `WASP_SERVER_URL`
- `WASP_WEB_CLIENT_URL`

## ğŸ› ï¸ å¼€å‘

### æ•°æ®åº“è¿ç§»

```bash
wasp db migrate-dev    # åº”ç”¨è¿ç§»
wasp db studio         # æ‰“å¼€ Prisma Studio
```

### ä»£ç é£æ ¼

é¡¹ç›®ä½¿ç”¨ Prettier è¿›è¡Œä»£ç æ ¼å¼åŒ–ï¼š

- Tab å®½åº¦ï¼š4 ä¸ªç©ºæ ¼
- æ‰“å°å®½åº¦ï¼š120 ä¸ªå­—ç¬¦

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚

1. Fork ä»“åº“
2. åˆ›å»ºæ‚¨çš„åŠŸèƒ½åˆ†æ”¯ï¼ˆ`git checkout -b feature/AmazingFeature`ï¼‰
3. æäº¤æ‚¨çš„æ›´æ”¹ï¼ˆ`git commit -m 'feat: add some AmazingFeature'`ï¼‰
4. æ¨é€åˆ°åˆ†æ”¯ï¼ˆ`git push origin feature/AmazingFeature`ï¼‰
5. æ‰“å¼€ Pull Request

### æäº¤è§„èŒƒ

æœ¬é¡¹ç›®éµå¾ªçº¦å®šå¼æäº¤ï¼š

- `feat:` æ–°åŠŸèƒ½
- `fix:` é”™è¯¯ä¿®å¤
- `docs:` æ–‡æ¡£æ›´æ”¹
- `style:` ä»£ç é£æ ¼æ›´æ”¹
- `refactor:` ä»£ç é‡æ„
- `test:` æµ‹è¯•æ·»åŠ /æ›´æ”¹
- `chore:` æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·æ›´æ”¹

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- ç‰¹åˆ«æ„Ÿè°¢ Zhiyuan Shao (<shao.zhiyu@northeastern.edu>)ï¼Œä»–æ¿€å‘äº†æ€ç»´å¯¼å›¾çš„æƒ³æ³•ã€‚

## ğŸ“§ è”ç³»æ–¹å¼

é¡¹ç›®é“¾æ¥ï¼š[https://github.com/WASD2HJKL/Non-Linear-Chatbot](https://github.com/WASD2HJKL/Non-Linear-Chatbot)
